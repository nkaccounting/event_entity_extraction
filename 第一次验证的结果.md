第一次模型评测结果10_6 fune-tune，10_7 evaluation

    {
        "exact ": 87.99102132435466,
        "f1 ": 87.99102132435466,
        "total ": 1782,
        "HasAns exact": 85.42234332425068,
        "HasAnsfl": 85.42234332425068,
        "HasAnstotal": 1468,
        "NoAns exact": 100.0,
        "NoAnsfl": 100.0,
        "NoAnstotal": 314
    }

一个bug，解析出来的答案prediction是有答案的格式是['str',(start:int,end:int)]，无答案为空

导致评测的程序错误处理数组和str--TODO，是不是run_squad发生了改变?

一些简单的解读： EM值和F值几个都是一致的 刚开始是程序有bug，SQuAD处理evaluation的时候是英文token，是按空格分词 ，而中文需要一个字算一个位置

--TODO：SAC资本，划分成了S A C 资 本来分析，英文串是否需要考虑成一个呢？

    {
        "exact": 87.99102132435466,
        "f1": 90.715851918643,
        "total": 1782,
        "HasAns exact": 85.42234332425068,
        "HasAns f1": 88.73000553066876,
        "HasAns total": 1468,
        "NoAns exact": 100.0,
        "NoAns fl": 100.0,
        "NoAns total": 314
    }

基本的正确率可以达到90%左右

测试有答案是1468，无答案是314；从大数据当中分层抽样出来，比例应该是一致的 无答案的情况为其他--训练的过程中有可能会过拟合，成功匹配100%
实际上应该是上游任务事件类型detection的任务，发现不了句子里面的事件类型，从而给了它一个其他 大概率训练出来是其他->无答案的表面线索，可以试试看问一个具体的事件类型，然后回答无答案

对于模型的训练，也许可以试着把其他替换成每一个类型的随机问题去问--这样也许能保证half，half的配比**（后来分析不可行**

正常有答案的是88%的正确率，先把这一部分的就是没有匹配出来的数据拿出来，分析一下它们可能存在什么理解上的问题

有一大部分是， 比如说宝钢信用抽成了宝钢 SAC资本抽成了SAC

想想怎么解决？ --method1，有监督的方法，做一个词典，然后适当修正，当做子集，姑且算他对，但是对评测结果的影响极小

--太长的target难以抽出，可能和数据初始分布有关，大多数的答案都是1-5 --有些抽出过于长的答案，几乎是一整句话,（Lmax）给截断一下

QAInput('业绩上涨', '山河智能(002097)遭股东减持700万股湘潭电化(002125)电解锰全线停产每月营收减少1500万'),
Inference一条，出现问题，其他的训练过于强了，遇到其他提问，倾向于抽取出“有问题的企业”，实际上应该是没有答案的情况 替换其他

仔细看了一下其他部分的数据 C：………… Q：其他 A:NAN 由于这个金融事件主体抽取其实是有一个上游任务，叫事件发现 其他里面属于是上游任务的一个错误累计 有些确实是没有事件，有些是有事件，但是没有能够抽取出来
对于说有事件的这部分，如果把它设置成问题每个问题，都回答不出来，那就比较麻烦了

    一个idea：用bert重新去做上游任务，cls处做一个分类器，分类每种事件类型，train
    一下，然后可以修复部分没有答案的情况，但是只能说是丰富的数据集。目前机器限制的
    情况下，暂时不考虑其他的情况，对每个句子提问CQA同时C Qother A--no answer

改变处理数据集的方法，no answer为当前Q以外的其他Q均为no answer
但是不能给模型倾向
举个例子，之前全是有answer，然后其他no answer，那么现在各种提问都会强行抽取东西，而no answer只对应其他（比较极端的100%的比例）
如果给到训练集有答案的比较多，他就会倾向于抽取答案，而不给no answer
那么现在设计问题的时候，最好保证50%，50%的设计倾向
17815（全部）-3141（其他）=14676
然后这14676随机采样一个另外的问题类型，然后设置为no answer

透过这样的设计，不知道有没有可能，去询问其他类型的数据
然后不依赖上游任务，把这些没有被识别出来的类型给识别出来

重新做了一次，看起来效果好了很多：
包含no-answer的生成式样本测评结果

    {
        "exact": 91.79155313351498,
        "fl": 93.21976089884444,
        "total": 2936,
        "HasAns exact": 86.78474114441417,
        "HasAns f": 89.641156675073,
        "HasAns total": 1468,
        "NoAns exact": 96.7983651226158,
        "NoAns fl": 96.7983651226158,
        "NoAns total": 1468
    }
回答“不可回答”问题的能力大幅度提升，并且能够判定什么是不可回答的问题

原始问答的生成结果，全部为有答案的情况

    {
        "exact": 86.78474114441417,
        "fl": 89.641156675073,
        "total": 1468,
        "HasAns exact": 86.78474114441417,
        "HasAns f1": 89.641156675073,
        "HasAns total": 1468
    }

相比于最初的原始状态，只看有answer的部分，88左右，现在也提升到89了

Inference三组数据：

    QAInput('业绩上涨', '山河智能(002097)遭股东减持700万股湘潭电化(002125)电解锰全线停产每月营收减少1500万'),
    QAInput('交易违规', '山河智能(002097)遭股东减持700万股湘潭电化(002125)电解锰全线停产每月营收减少1500万'),
    QAInput('不能履职', '成都中禾投资公司老板跑路 专家忧年底或现倒闭潮昆百大A(000560)重要股东累计减持5850万股'),

输出结果为

    湘潭电化（没有训练到的问题类型，机器肯定认为业绩上涨接近业绩下滑--表面clue，没有真正理解语言
    no answer（先可以理解为，可以在有限的问题类型（训练到的）里面判断出无答案
    成都中禾投资公司

##关于不在这21个问题类型里面的回答
目前的泛化性研究肯定是不行的
一种方法是生成随机问题，然后去询问，得到无答案
但个人觉得这部分没有必要，可以参考专家系统，程序过滤，或者做一个分类器
论文--Adaptive Mixtures of Local Experts
http://www.cs.toronto.edu/~fritz/absps/jjnh91.pdf
一些bert模型专门分类业绩不好的情况，一些bert模型专门分类业绩表现好的情况

todo：最后再分析一下看看哪些表现不太好，基本上就差不多了
然后可以做一下ner问题
